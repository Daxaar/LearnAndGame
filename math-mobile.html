<!DOCTYPE html> 
<html> 
	<head> 
	<title>Page Title</title> 
	
	<meta name="viewport" content="width=device-width, initial-scale=1"> 

	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0rc2/jquery.mobile-1.0rc2.min.css" />
	
	<script src="Scripts/jquery-1.6.4.min.js" type="text/javascript"></script>
	<script src="Scripts/jquery.mobile-1.0rc2.min.js" type="text/javascript"></script>
	<script src="Scripts/knockout-1.3.0beta.debug.js" type="text/javascript"></script>
	<script src="underscore.1.2.1.debug.js" type="text/javascript"></script>
	<script src="js/countdown.1.5.11/jquery.countdown.js" type="text/javascript"></script>
	<link type="text/css" rel="stylesheet" href="js/countdown.1.5.11/jquery.countdown.css"/>
<!--	<link type="text/css" rel="stylesheet" href="content/screen.css" media="screen"/>
	<link type="text/css" rel="stylesheet" href="content/print.css" media="print"/>-->
	<script src="Scripts/mathGame.js" type="text/javascript"></script>
	
</head> 
<body> 

<div data-role="page" id="#welcome">

	<div data-role="header">
		<h1>Math Games</h1>
		<a href="#numberBonds">Number Bonds</a>
	</div><!-- /header -->

	<div data-role="content">	
		<p></p>		
	</div><!-- /content -->

	<div data-role="footer">
		<h4>Page Footer</h4>
	</div><!-- /footer -->
</div><!-- /page -->

<div data-role="page" id="#numberBonds">

	<div data-role="header">
		<h1>Number Bonds</h1>
	</div><!-- /header -->

	<div data-role="content">
		<div id="#criteria">
		<div id="timer" style="width:120px"></div>
		<h3 data-bind="text: 'Completed ' + answeredQuestions().length + ' out of ' + numberOfQuestionsSelected()"></h3>	

		<div id="questionContainer">
			<div id="questionGrid" data-bind="foreach: questionGrid">
				<div data-bind="foreach:questionRow">
					<div class="question">
						<div  data-bind="text: left()"></div>
						<div  data-bind="text: sign()"></div>
						<div  data-bind="text: right()"></div>

						<input type="text" 
						data-bind="disable: $root.timeLeft() === 0,value: givenAnswer, style: { color: isCorrect() ? 'green' : 'red' }">
					</div>
				</div>
			</div>
		</div>
	</div><!-- /content -->

	<div data-role="footer">
		<h4>Page Footer</h4>
	</div><!-- /footer -->
</div><!-- /page -->

</body>

<script type="text/javascript">
    $(document).ready(function () {

        $('button').button();

        $("#createQuestions").click(function () {
            viewModel.questionGrid.removeAll(); //  = ko.observableArray([]);
            var columnCount = 5;
            var rowCount = viewModel.numberOfQuestionsSelected() / columnCount;

            //var grid = { columns: 5, rows: viewModel.numberOfQuestionsSelected() / this.columns };

            for (j = 0; j < rowCount; j++) {
                viewModel.questionGrid.push({ questionRow: ko.observableArray() });
                for (i = 0; i < columnCount; i++) {
                    var question = new Question(viewModel.nextNumber(), viewModel.nextNumber(), viewModel.questionTypeSelected());
                    viewModel.questionGrid()[j].questionRow.push(question);
                };
            };
            $('#timer').countdown('destroy');
            $('#timer').countdown({ until: viewModel.timeOptionSelected() * 60,
                                    onTick: watchCountdown,
                                    format: 'MS',
                                    tickInterval: 5, 
                                    onExpiry: disableGrid});
        });
                            //viewModel.timeOptionSelected() * 60
        function watchCountdown(periods) {
            viewModel.timeLeft(periods[5] + periods[6]);
            console.log(viewModel.timeLeft());
        }


        function disableGrid() {
            viewModel.outOfTime(true);
            $("#questionContainer").css({opacity:1,display:'block'}).animate({opacity:0.5},1000);
        }

        ko.applyBindings(viewModel);
    });
</script>
</html>