<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Minute Math Club</title>
	<meta name="author" content="Darren Lewis">
	
	<script src="Scripts/jquery-1.6.4.min.js" type="text/javascript"></script>
	<script src="Scripts/knockout-1.3.0beta.debug.js" type="text/javascript"></script>
	<script src="underscore.1.2.1.debug.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/countdown.1.5.11/jquery.countdown.js"></script>
	<link type="text/css" rel="stylesheet" href="js/countdown.1.5.11/jquery.countdown.css"/>
	<link type="text/css" rel="stylesheet" href="content/screen.css" media="screen"/>
	<link type="text/css" rel="stylesheet" href="content/print.css" media="print"/>
	<script src="Scripts/mathGame.js" type="text/javascript"></script>
	<link href="content/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />

	<script src="Scripts/jquery-ui-1.8.16.js" type="text/javascript"></script>
	<script src="Scripts/jquery.bouncebox.1.0.js" type="text/javascript"></script>
<script src="Scripts/jquery.easing.1.3.js" type="text/javascript"></script>
</head>
<body>
		

	<div class="nav left col">
		<ul>
			<!-- ko foreach: games-->
			<li class="gameTile"><a data-bind="text:name"></a></li>
			<!-- /ko -->
		</ul>
	</div>
	<div class="right col">
		<div class="header row">
		</div>
		<div class="body row scroll-y">
			<div class="container">
			<div id="#criteria">
				<label>Numbers Bonds:</label><select data-bind="options: numberBondsTo, value:numberBondsToSelected"></select>
				<label>Questions:</label><select data-bind="options: numberOfQuestions, value:numberOfQuestionsSelected"></select>
				<label>Time:</label><select data-bind="options: timeOptions, value:timeOptionSelected"></select>
				<label>Type:</label><select data-bind="options: questionTypes, optionsText: 'text', optionsValue: 'value', value:questionTypeSelected"></select>
				<div>
				<button id="createQuestions" data-bind="text: isComplete() ? 'Finish' : 'Start'"></button>
				</div>
			</div>


			<div id="timer" style="width:120px"></div>
			<h3 style="clear:both" data-bind="text: 'Completed ' + answeredQuestions().length + ' out of ' + numberOfQuestionsSelected()"></h3>	

			<div id="questionContainer" data-bind="toggleGrid: isComplete()">
				<div id="questionGrid" data-bind="foreach: questionGrid">
					<div class="questionRow" data-bind="foreach:questionRow">
						<div class="question">
							<div class="questionPart" data-bind="text: left()"></div>
							<div class="questionPart" data-bind="text: sign()"></div>
							<div class="questionPart" data-bind="text: right()"></div>

							<input class="answer" style="float:left" type="text" 
							data-bind="disable: $root.isComplete(),value: givenAnswer, style: { color: isCorrect() ? 'green' : 'red' }">
						</div>
					</div>
				</div>
			</div>
			</div> <!--container-->
		</div>
		
		<div class="footer row">
			Some status message here
		</div>
	</div>

	<div id="scorebox" data-bind="visible: isComplete(), animateVisible: isComplete(), click:reset">
		<h2 data-bind="visible:outOfTime()">Time's Up!</h2>
		<h2 data-bind="text: 'You scored ' + score() + ' out of ' + numberOfQuestionsSelected()"></h2>
		<h2 id="scoreMessage"></h2>
	</div>

	<div class="scroll" data-bind="text:ko.toJSON(viewModel), visible: isComplete() == false"></div> 
</body>

<script type="text/javascript">
    $(document).ready(function () {
        
        $('button').button();

        $("#createQuestions").click(function () {

        	viewModel.reset({columnCount:5});	
            
            viewModel.timeOptionSelected(0.5);
            console.log('time adjusted to: ' + viewModel.timeOptionSelected());

            $('#timer').countdown('destroy');
            $('#timer').countdown({ until: viewModel.timeOptionSelected() * 60,
                                    format: 'MS',
                                    tickInterval: 5, 
                                    onExpiry: function(){
	                                    viewModel.outOfTime(true);
	                                    viewModel.score();
	                                    }});
        });

        console.log('applying bindings');
        ko.applyBindings(viewModel);
    });
</script>
</html>